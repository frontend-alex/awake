#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "  Running pre-commit quality checks..."

echo ""
echo "  Step 1/2: Running tests..."
pnpm test
TEST_EXIT_CODE=$?

if [ $TEST_EXIT_CODE -ne 0 ]; then
  echo ""
  echo "  Tests failed. Commit aborted."
  echo "   Fix failing tests before committing."
  exit $TEST_EXIT_CODE
fi

echo ""
echo "  Tests passed."
echo ""
echo "  Step 2/2: Running lint checks..."
pnpm lint
LINT_EXIT_CODE=$?

if [ $LINT_EXIT_CODE -ne 0 ]; then
  echo ""
  echo "   Lint checks failed. Commit aborted."
  echo "   Fix linting errors before committing."
  exit $LINT_EXIT_CODE
fi

echo ""
echo "  All quality checks passed. Proceeding with commit."

